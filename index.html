<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Training Tracker Pro - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #0a0e27;
            color: #e0e0e0;
            line-height: 1.6;
        }

        /* ===== LOGIN SCREEN ===== */
        .login-screen {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 100%);
        }

        .login-box {
            background: #1a1f3a;
            border: 2px solid #00d084;
            border-radius: 12px;
            padding: 60px 40px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0, 208, 132, 0.2);
            max-width: 400px;
            width: 100%;
        }

        .login-box h1 {
            font-size: 32px;
            color: #00d084;
            margin-bottom: 15px;
            text-shadow: 0 0 10px rgba(0, 208, 132, 0.5);
        }

        .login-box p {
            color: #b0b0b0;
            margin-bottom: 40px;
            font-size: 14px;
        }

        .login-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .btn-login {
            padding: 16px 24px;
            font-size: 16px;
            font-weight: 600;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-athlete {
            background: #00d084;
            color: #0a0e27;
        }

        .btn-athlete:hover {
            background: #00e699;
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 208, 132, 0.4);
        }

        .btn-supervisor {
            background: #ff6b35;
            color: #fff;
        }

        .btn-supervisor:hover {
            background: #ff8555;
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(255, 107, 53, 0.4);
        }

        .app-hidden {
            display: none !important;
        }

        .header {
            background: #1a1f3a;
            border-bottom: 2px solid #00d084;
            padding: 20px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 8px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .role-badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
        }

        .role-athlete {
            background: #00d084;
            color: #0a0e27;
        }

        .role-supervisor {
            background: #ff6b35;
            color: #fff;
        }

        .header-right {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .btn-logout {
            padding: 10px 20px;
            background: #ff6b35;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            transition: all 0.3s;
        }

        .btn-logout:hover {
            background: #ff8555;
        }

        .controls {
            background: #1a1f3a;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #00d084;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }

        .select-week, .select-day, .select-week-supervisor {
            background: #0a0e27;
            color: #e0e0e0;
            padding: 10px 15px;
            border: 1px solid #00d084;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
        }

        .select-week:focus, .select-day:focus, .select-week-supervisor:focus {
            outline: none;
            border-color: #00e699;
            box-shadow: 0 0 10px rgba(0, 208, 132, 0.3);
        }

        .workouts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 15px;
        }

        .workout-card {
            background: #1a1f3a;
            border: 2px solid #333;
            border-radius: 8px;
            padding: 20px;
            transition: all 0.3s;
        }

        .workout-card:hover {
            border-color: #00d084;
            box-shadow: 0 10px 25px rgba(0, 208, 132, 0.2);
        }

        .workout-card.completed {
            border-color: #00d084;
            background: rgba(0, 208, 132, 0.05);
        }

        .workout-card.cancelled {
            border-color: #ff6b35;
            background: rgba(255, 107, 53, 0.05);
            opacity: 0.7;
        }

        .workout-title {
            font-size: 16px;
            font-weight: 700;
            color: #00d084;
            margin-bottom: 10px;
        }

        .workout-type {
            font-size: 12px;
            color: #888;
            background: #0a0e27;
            padding: 4px 8px;
            border-radius: 4px;
            display: inline-block;
            margin-bottom: 12px;
        }

        .workout-details {
            font-size: 13px;
            color: #b0b0b0;
            margin-bottom: 15px;
            line-height: 1.8;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 6px;
        }

        .detail-label {
            color: #888;
        }

        .detail-value {
            color: #e0e0e0;
            font-weight: 600;
        }

        .workout-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .btn-small {
            padding: 8px 12px;
            font-size: 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }

        .btn-complete {
            background: #00d084;
            color: #0a0e27;
            flex: 1;
            min-width: 100px;
        }

        .btn-complete:hover {
            background: #00e699;
        }

        .btn-edit {
            background: #4a5f8f;
            color: white;
            flex: 1;
            min-width: 80px;
        }

        .btn-edit:hover {
            background: #5a6fa0;
        }

        .btn-cancel {
            background: #ff6b35;
            color: white;
            flex: 1;
            min-width: 80px;
        }

        .btn-cancel:hover {
            background: #ff8555;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: #1a1f3a;
            border: 2px solid #00d084;
            border-radius: 12px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-title {
            font-size: 24px;
            color: #00d084;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 13px;
            color: #00d084;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 12px;
            background: #0a0e27;
            color: #e0e0e0;
            border: 1px solid #333;
            border-radius: 6px;
            font-family: inherit;
            font-size: 14px;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: #00d084;
            box-shadow: 0 0 10px rgba(0, 208, 132, 0.3);
        }

        .form-textarea {
            resize: vertical;
            min-height: 80px;
        }

        .modal-buttons {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }

        .btn-primary {
            flex: 1;
            padding: 12px;
            background: #00d084;
            color: #0a0e27;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 700;
            transition: all 0.3s;
        }

        .btn-primary:hover {
            background: #00e699;
        }

        .btn-secondary {
            flex: 1;
            padding: 12px;
            background: #333;
            color: #e0e0e0;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 700;
            transition: all 0.3s;
        }

        .btn-secondary:hover {
            background: #444;
        }

        .dashboard-container {
            background: #1a1f3a;
            border: 1px solid #00d084;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }

        .dashboard-title {
            font-size: 20px;
            color: #00d084;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .dashboard-card {
            background: #0a0e27;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }

        .dashboard-label {
            font-size: 12px;
            color: #888;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .dashboard-value {
            font-size: 32px;
            color: #00d084;
            font-weight: 700;
        }

        .dashboard-status {
            font-size: 12px;
            color: #b0b0b0;
            margin-top: 8px;
        }

        .status-ok {
            color: #00d084;
        }

        .status-warning {
            color: #ff9800;
        }

        .status-error {
            color: #ff6b35;
        }

        .supervisor-table {
            background: #1a1f3a;
            border: 1px solid #00d084;
            border-radius: 8px;
            overflow: hidden;
            margin-top: 20px;
        }

        .table-scroll {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            background: #0a0e27;
            border-bottom: 2px solid #00d084;
        }

        th {
            padding: 15px;
            text-align: left;
            font-size: 12px;
            color: #00d084;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #333;
            font-size: 13px;
            color: #b0b0b0;
        }

        tr:hover {
            background: rgba(0, 208, 132, 0.05);
        }

        tr.completed {
            background: rgba(0, 208, 132, 0.1);
        }

        tr.cancelled {
            background: rgba(255, 107, 53, 0.1);
            opacity: 0.8;
        }

        .editable-cell {
            cursor: pointer;
            padding: 8px;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .editable-cell:hover {
            background: rgba(0, 208, 132, 0.2);
        }

        .editable-cell input {
            background: #0a0e27;
            color: #e0e0e0;
            border: 1px solid #00d084;
            padding: 6px;
            border-radius: 4px;
            font-size: 13px;
        }

        .sync-status {
            display: inline-block;
            padding: 4px 12px;
            background: #00d084;
            color: #0a0e27;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 700;
        }

        @media (max-width: 768px) {
            .workouts-grid {
                grid-template-columns: 1fr;
            }

            .modal-content {
                padding: 20px;
                width: 95%;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            th, td {
                padding: 10px;
                font-size: 11px;
            }
        }
    </style>
</head>
<body>
    <!-- LOGIN SCREEN -->
    <div id="loginScreen" class="login-screen">
        <div class="login-box">
            <h1>üèÉ TRAINING TRACKER PRO</h1>
            <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫<br>–¥–ª—è —Å–ø–æ—Ä—Ç—Å–º–µ–Ω–∞ –∏ —Å—É–ø–µ—Ä–≤–∞–π–∑–µ—Ä–∞</p>
            <div class="login-buttons">
                <button class="btn-login btn-athlete" onclick="login('athlete')">
                    üèÉ –í–æ–π—Ç–∏ –∫–∞–∫ —Å–ø–æ—Ä—Ç—Å–º–µ–Ω
                </button>
                <button class="btn-login btn-supervisor" onclick="login('supervisor')">
                    üë®‚Äçüè´ –í–æ–π—Ç–∏ –∫–∞–∫ —Å—É–ø–µ—Ä–≤–∞–π–∑–µ—Ä
                </button>
            </div>
            <p style="margin-top: 30px; font-size: 12px; color: #666;">
                Demo Mode ‚Ä¢ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ
            </p>
        </div>
    </div>

    <!-- MAIN APP -->
    <div id="mainApp" class="app-hidden">
        <!-- HEADER -->
        <div class="header">
            <div class="header-left">
                <h1 style="font-size: 24px; color: #00d084;">üèÉ TRAINING TRACKER</h1>
                <span id="roleDisplay" class="role-badge"></span>
            </div>
            <div class="header-right">
                <span id="syncStatus" style="font-size: 12px; color: #00d084;"></span>
                <button class="btn-logout" onclick="logout()">–í—ã—Ö–æ–¥</button>
            </div>
        </div>

        <!-- ATHLETE VIEW -->
        <div id="athleteView" class="app-hidden">
            <div class="controls">
                <select id="selectWeek" class="select-week" onchange="updateAthleteWorkouts()">
                    <option value="0">–ù–µ–¥–µ–ª—è 1 (01-07.12)</option>
                </select>
                <select id="selectDay" class="select-day" onchange="updateAthleteWorkouts()">
                    <option value="0">–ü–Ω</option>
                    <option value="1">–í—Ç</option>
                    <option value="2">–°—Ä</option>
                    <option value="3">–ß—Ç</option>
                    <option value="4">–ü—Ç</option>
                    <option value="5">–°–±</option>
                    <option value="6">–í—Å</option>
                </select>
            </div>

            <div id="workoutsContainer" class="workouts-grid"></div>

            <!-- ATHLETE DASHBOARDS -->
            <div class="dashboard-container">
                <div class="dashboard-title">üìä –î–∞—à–±–æ—Ä–¥ –Ω–µ–¥–µ–ª–∏</div>
                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <div class="dashboard-label">–í—ã–ø–æ–ª–Ω–µ–Ω–æ —É–ø—Ä.</div>
                        <div class="dashboard-value" id="completedCount">0</div>
                    </div>
                    <div class="dashboard-card">
                        <div class="dashboard-label">% –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</div>
                        <div class="dashboard-value" id="completionPercent">0%</div>
                        <div class="dashboard-status" id="completionStatus"></div>
                    </div>
                    <div class="dashboard-card">
                        <div class="dashboard-label">–°—Ä–µ–¥–Ω–∏–π RPE</div>
                        <div class="dashboard-value" id="avgRPE">0.0</div>
                    </div>
                    <div class="dashboard-card">
                        <div class="dashboard-label">S-–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç</div>
                        <div class="dashboard-value" id="sCoeff">0.0</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- SUPERVISOR VIEW -->
        <div id="supervisorView" class="app-hidden">
            <div class="controls">
                <select id="selectWeekSupervisor" class="select-week-supervisor" onchange="updateSupervisorView()">
                    <option value="0">–ù–µ–¥–µ–ª—è 1 (01-07.12) ‚Ä¢ –ê–î–ê–ü–¢–ê–¶–ò–Ø</option>
                </select>
            </div>

            <div class="supervisor-table">
                <div class="table-scroll">
                    <table id="supervisorTable"></table>
                </div>
            </div>

            <!-- SUPERVISOR DASHBOARDS -->
            <div class="dashboard-container">
                <div class="dashboard-title">üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ –Ω–µ–¥–µ–ª–∏</div>
                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <div class="dashboard-label">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</div>
                        <div class="dashboard-value" id="supervisorCompleted">0</div>
                    </div>
                    <div class="dashboard-card">
                        <div class="dashboard-label">% –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</div>
                        <div class="dashboard-value" id="supervisorPercent">0%</div>
                        <div class="dashboard-status" id="supervisorStatus"></div>
                    </div>
                    <div class="dashboard-card">
                        <div class="dashboard-label">–°—Ä–µ–¥–Ω–∏–π RPE</div>
                        <div class="dashboard-value" id="supervisorAvgRPE">0.0</div>
                    </div>
                    <div class="dashboard-card">
                        <div class="dashboard-label">S-–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç</div>
                        <div class="dashboard-value" id="supervisorSCoeff">0.0</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- LOG MODAL -->
    <div id="logModal" class="modal">
        <div class="modal-content">
            <div class="modal-title">üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</div>
            <div class="form-group">
                <label class="form-label">–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ</label>
                <input type="text" id="logExerciseName" class="form-input" readonly>
            </div>
            <div class="form-group">
                <label class="form-label">–§–∞–∫—Ç. –ø—É–ª—å—Å (—É–¥/–º–∏–Ω)</label>
                <input type="number" id="logPulse" class="form-input" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 135">
            </div>
            <div class="form-group">
                <label class="form-label">RPE (—Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π, 1-10)</label>
                <input type="number" id="logRPE" class="form-input" min="1" max="10" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 5">
            </div>
            <div class="form-group">
                <label class="form-label">–°–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ</label>
                <select id="logMood" class="form-select">
                    <option value="">-- –í—ã–±–µ—Ä–∏ --</option>
                    <option value="–û—Ç–ª–∏—á–Ω–æ">‚úÖ –û—Ç–ª–∏—á–Ω–æ</option>
                    <option value="–•–æ—Ä–æ—à–æ">üëç –•–æ—Ä–æ—à–æ</option>
                    <option value="–ù–æ—Ä–º–∞–ª—å–Ω–æ">üòê –ù–æ—Ä–º–∞–ª—å–Ω–æ</option>
                    <option value="–ü–ª–æ—Ö–æ">üòû –ü–ª–æ—Ö–æ</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">–ü—Ä–∏–º–µ—á–∞–Ω–∏—è</label>
                <textarea id="logNotes" class="form-textarea" placeholder="–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ"></textarea>
            </div>
            <div class="modal-buttons">
                <button class="btn-primary" onclick="saveLogData()">üíæ –û—Ç–º–µ—Ç–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º</button>
                <button class="btn-secondary" onclick="closeModal()">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <!-- EDIT MODAL -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <div class="modal-title">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ</div>
            <div class="form-group">
                <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
                <input type="text" id="editExerciseName" class="form-input" readonly>
            </div>
            <div class="form-group">
                <label class="form-label">–ü–æ–¥—Ö–æ–¥—ã</label>
                <input type="number" id="editSets" class="form-input" min="1">
            </div>
            <div class="form-group">
                <label class="form-label">–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏—è</label>
                <input type="text" id="editReps" class="form-input">
            </div>
            <div class="form-group">
                <label class="form-label">–í–µ—Å</label>
                <input type="text" id="editWeight" class="form-input">
            </div>
            <div class="form-group">
                <label class="form-label">RPE (1-10)</label>
                <input type="number" id="editRPE" class="form-input" min="1" max="10">
            </div>
            <div class="modal-buttons">
                <button class="btn-primary" onclick="saveEditedWorkout()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button class="btn-secondary" onclick="closeModal()">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <!-- CANCEL MODAL -->
    <div id="cancelModal" class="modal">
        <div class="modal-content">
            <div class="modal-title">‚ùå –û—Ç–º–µ–Ω–∏—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ</div>
            <div class="form-group">
                <label class="form-label">–ü—Ä–∏—á–∏–Ω–∞ –æ—Ç–º–µ–Ω—ã</label>
                <select id="cancelReason" class="form-select">
                    <option value="">-- –í—ã–±–µ—Ä–∏ –ø—Ä–∏—á–∏–Ω—É --</option>
                    <option value="–ë–æ–ª—å / —Ç—Ä–∞–≤–º–∞">üî¥ –ë–æ–ª—å / —Ç—Ä–∞–≤–º–∞</option>
                    <option value="–£—Å—Ç–∞–ª–æ—Å—Ç—å / –ø–µ—Ä–µ—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å">üò¥ –£—Å—Ç–∞–ª–æ—Å—Ç—å / –ø–µ—Ä–µ—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å</option>
                    <option value="–õ–∏—á–Ω—ã–µ –¥–µ–ª–∞">üìû –õ–∏—á–Ω—ã–µ –¥–µ–ª–∞</option>
                    <option value="–ë–æ–ª–µ–∑–Ω—å">ü§í –ë–æ–ª–µ–∑–Ω—å</option>
                    <option value="–î—Ä—É–≥–æ–µ">üö´ –î—Ä—É–≥–æ–µ</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                <textarea id="cancelComment" class="form-textarea"></textarea>
            </div>
            <div class="modal-buttons">
                <button class="btn-primary" style="background: #ff6b35;" onclick="confirmCancel()">‚úì –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
                <button class="btn-secondary" onclick="closeModal()">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <script>
        // TRAINING DATA (–ù–ï–î–ï–õ–Ø 1)
        const TRAINING_DATA = [
            {
                week: 1,
                phase: "–ê–î–ê–ü–¢–ê–¶–ò–Ø",
                days: [
                    { date: "01.12.2025", day: "–ü–Ω", workouts: [{ exercise: "–õ—ë–≥–∫–∏–π –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ–ª—å–Ω—ã–π –∫—Ä–æ—Å—Å", type: "–ë–µ–≥ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ–ª—å–Ω—ã–π", duration: "45 –º–∏–Ω", rpe: 3 }] },
                    { date: "02.12.2025", day: "–í—Ç", workouts: [{ exercise: "–°–ë–£ –∫–æ–º–ø–ª–µ–∫—Å", type: "–û–§–ü/–°–ë–£", duration: "15-20 –º–∏–Ω", rpe: 4 }, { exercise: "Single-Leg RDL", type: "–û–§–ü", sets: 3, reps: "8 –Ω–∞ –Ω–æ–≥—É", weight: "16 –∫–≥", rpe: 5 }, { exercise: "Bulgarian Split Squat", type: "–û–§–ü", sets: 3, reps: "8 –Ω–∞ –Ω–æ–≥—É", weight: "BW", rpe: 5 }] },
                    { date: "03.12.2025", day: "–°—Ä", workouts: [{ exercise: "–°—Ä–µ–¥–Ω–∏–π —Ç–µ–º–ø–æ–≤—ã–π", type: "–ë–µ–≥ —Ç–µ–º–ø–æ–≤—ã–π", duration: "60 –º–∏–Ω", rpe: 4 }] },
                    { date: "04.12.2025", day: "–ß—Ç", workouts: [{ exercise: "Romanian Deadlift", type: "–°–∏–ª–æ–≤–∞—è –î1", sets: 3, reps: "8", weight: "80/90/100 –∫–≥", rpe: 7 }, { exercise: "Bench Press", type: "–°–∏–ª–æ–≤–∞—è –î1", sets: 3, reps: "8", weight: "55/60/60 –∫–≥", rpe: 6 }] },
                    { date: "05.12.2025", day: "–ü—Ç", workouts: [{ exercise: "–õ—ë–≥–∫–∏–π –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ–ª—å–Ω—ã–π", type: "–ë–µ–≥ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ–ª—å–Ω—ã–π", duration: "35 –º–∏–Ω", rpe: 3 }] },
                    { date: "06.12.2025", day: "–°–±", workouts: [{ exercise: "–î–ª–∏–Ω–Ω—ã–π –º–µ–¥–ª–µ–Ω–Ω—ã–π", type: "–ë–µ–≥ –¥–ª–∏–Ω–Ω—ã–π", duration: "75 –º–∏–Ω", rpe: 3 }] },
                    { date: "07.12.2025", day: "–í—Å", workouts: [{ exercise: "Inverted Row", type: "–õ—ë–≥–∫–∞—è –≤–µ—Ä—Ö/–∫–æ—Ä", sets: 3, reps: "10-12", weight: "BW", rpe: 4 }] }
                ]
            }
        ];

        // APP STATE
        let appState = {
            currentRole: null,
            currentWeek: 0,
            currentDay: 6,
            workoutData: {},
            editingId: null
        };

        // LOGIN
        function login(role) {
            appState.currentRole = role;
            document.getElementById('loginScreen').classList.add('app-hidden');
            document.getElementById('mainApp').classList.remove('app-hidden');

            if (role === 'athlete') {
                document.getElementById('athleteView').classList.remove('app-hidden');
                document.getElementById('supervisorView').classList.add('app-hidden');
                document.getElementById('roleDisplay').textContent = 'üèÉ –°–ø–æ—Ä—Ç—Å–º–µ–Ω';
                document.getElementById('roleDisplay').className = 'role-badge role-athlete';
            } else {
                document.getElementById('athleteView').classList.add('app-hidden');
                document.getElementById('supervisorView').classList.remove('app-hidden');
                document.getElementById('roleDisplay').textContent = 'üë®‚Äçüè´ –°—É–ø–µ—Ä–≤–∞–π–∑–µ—Ä';
                document.getElementById('roleDisplay').className = 'role-badge role-supervisor';
            }

            loadWorkoutData();
            updateAthleteWorkouts();
            updateSupervisorView();
        }

        function logout() {
            appState.currentRole = null;
            document.getElementById('loginScreen').classList.remove('app-hidden');
            document.getElementById('mainApp').classList.add('app-hidden');
        }

        function loadWorkoutData() {
            const stored = localStorage.getItem('workoutData');
            appState.workoutData = stored ? JSON.parse(stored) : {};
        }

        function saveWorkoutData() {
            localStorage.setItem('workoutData', JSON.stringify(appState.workoutData));
            showSyncStatus();
        }

        function showSyncStatus() {
            const status = document.getElementById('syncStatus');
            status.textContent = '‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ';
            setTimeout(() => { status.textContent = ''; }, 2000);
        }

        function updateAthleteWorkouts() {
            const week = document.getElementById('selectWeek').value;
            const day = document.getElementById('selectDay').value;
            const container = document.getElementById('workoutsContainer');

            appState.currentWeek = week;
            appState.currentDay = day;

            const dayData = TRAINING_DATA[week]?.days[day];
            if (!dayData) {
                container.innerHTML = '<p style="color: #888;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</p>';
                return;
            }

            let html = '';
            dayData.workouts.forEach((workout, index) => {
                const workoutId = `${week}-${day}-${index}`;
                const record = appState.workoutData[workoutId] || {};
                const isCompleted = record.completed || false;
                const isCancelled = record.cancelled || false;

                html += `
                    <div class="workout-card ${isCompleted ? 'completed' : ''} ${isCancelled ? 'cancelled' : ''}">
                        <div class="workout-title">${workout.exercise}</div>
                        <div class="workout-type">${workout.type}</div>
                        <div class="workout-details">
                            ${workout.duration ? `<div class="detail-row"><span class="detail-label">‚è±Ô∏è –í—Ä–µ–º—è:</span><span class="detail-value">${workout.duration}</span></div>` : ''}
                            ${workout.sets ? `<div class="detail-row"><span class="detail-label">–ü–æ–¥—Ö–æ–¥—ã:</span><span class="detail-value">${workout.sets}</span></div>` : ''}
                            ${workout.reps ? `<div class="detail-row"><span class="detail-label">–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏—è:</span><span class="detail-value">${workout.reps}</span></div>` : ''}
                            ${workout.weight ? `<div class="detail-row"><span class="detail-label">–í–µ—Å:</span><span class="detail-value">${workout.weight}</span></div>` : ''}
                            <div class="detail-row"><span class="detail-label">RPE:</span><span class="detail-value">${record.rpe || workout.rpe}</span></div>
                            ${record.pulse ? `<div class="detail-row"><span class="detail-label">–ü—É–ª—å—Å:</span><span class="detail-value">${record.pulse} —É–¥/–º–∏–Ω</span></div>` : ''}
                            ${record.mood ? `<div class="detail-row"><span class="detail-label">–°–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ:</span><span class="detail-value">${record.mood}</span></div>` : ''}
                            ${record.notes ? `<div class="detail-row"><span class="detail-label">–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:</span><span class="detail-value">${record.notes}</span></div>` : ''}
                        </div>
                        <div class="workout-actions">
                            ${!isCancelled ? `<button class="btn-small btn-complete" onclick="openLogModal('${workoutId}', '${workout.exercise}')">${isCompleted ? '‚úÖ –û—Ç–º–µ—Ç–∏—Ç—å –µ—â—ë —Ä–∞–∑' : '‚¨ú –û—Ç–º–µ—Ç–∏—Ç—å'}</button>` : ''}
                            ${!isCancelled ? `<button class="btn-small btn-edit" onclick="openEditModal('${workoutId}', '${workout.exercise}', ${workout.sets || 0}, '${workout.reps || ''}', '${workout.weight || ''}', ${workout.rpe || 0})">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>` : ''}
                            ${!isCancelled ? `<button class="btn-small btn-cancel" onclick="openCancelModal('${workoutId}')">‚ùå –û—Ç–º–µ–Ω–∏—Ç—å</button>` : ''}
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
            updateDashboards();
        }

        function openLogModal(workoutId, exerciseName) {
            appState.editingId = workoutId;
            document.getElementById('logExerciseName').value = exerciseName;
            document.getElementById('logPulse').value = '';
            document.getElementById('logRPE').value = '';
            document.getElementById('logMood').value = '';
            document.getElementById('logNotes').value = '';
            document.getElementById('logModal').classList.add('active');
        }

        function saveLogData() {
            const id = appState.editingId;
            if (!appState.workoutData[id]) appState.workoutData[id] = {};

            appState.workoutData[id].completed = true;
            appState.workoutData[id].pulse = document.getElementById('logPulse').value || '';
            appState.workoutData[id].rpe = document.getElementById('logRPE').value || appState.workoutData[id].rpe;
            appState.workoutData[id].mood = document.getElementById('logMood').value || '';
            appState.workoutData[id].notes = document.getElementById('logNotes').value || '';
            appState.workoutData[id].timestamp = new Date().toISOString();

            saveWorkoutData();
            closeModal();
            updateAthleteWorkouts();
        }

        function openEditModal(workoutId, exerciseName, sets, reps, weight, rpe) {
            appState.editingId = workoutId;
            document.getElementById('editExerciseName').value = exerciseName;
            document.getElementById('editSets').value = sets;
            document.getElementById('editReps').value = reps;
            document.getElementById('editWeight').value = weight;
            document.getElementById('editRPE').value = rpe;
            document.getElementById('editModal').classList.add('active');
        }

        function saveEditedWorkout() {
            const id = appState.editingId;
            if (!appState.workoutData[id]) appState.workoutData[id] = {};

            appState.workoutData[id].sets = document.getElementById('editSets').value;
            appState.workoutData[id].reps = document.getElementById('editReps').value;
            appState.workoutData[id].weight = document.getElementById('editWeight').value;
            appState.workoutData[id].rpe = document.getElementById('editRPE').value;

            saveWorkoutData();
            closeModal();
            updateAthleteWorkouts();
        }

        function openCancelModal(workoutId) {
            appState.editingId = workoutId;
            document.getElementById('cancelReason').value = '';
            document.getElementById('cancelComment').value = '';
            document.getElementById('cancelModal').classList.add('active');
        }

        function confirmCancel() {
            const reason = document.getElementById('cancelReason').value;
            if (!reason) {
                alert('–í—ã–±–µ—Ä–∏ –ø—Ä–∏—á–∏–Ω—É!');
                return;
            }

            const id = appState.editingId;
            if (!appState.workoutData[id]) appState.workoutData[id] = {};

            appState.workoutData[id].cancelled = true;
            appState.workoutData[id].cancelReason = reason;
            appState.workoutData[id].cancelComment = document.getElementById('cancelComment').value;

            saveWorkoutData();
            closeModal();
            updateAthleteWorkouts();
        }

        function closeModal() {
            document.getElementById('logModal').classList.remove('active');
            document.getElementById('editModal').classList.remove('active');
            document.getElementById('cancelModal').classList.remove('active');
        }

        function updateDashboards() {
            const week = appState.currentWeek;
            const day = appState.currentDay;
            let total = 0, completed = 0, totalRPE = 0;

            const dayData = TRAINING_DATA[week]?.days[day];
            if (dayData) {
                dayData.workouts.forEach((workout, index) => {
                    const id = `${week}-${day}-${index}`;
                    const record = appState.workoutData[id] || {};
                    total++;
                    if (record.completed) completed++;
                    const rpe = parseInt(record.rpe || workout.rpe || 0);
                    if (rpe > 0) totalRPE += rpe;
                });
            }

            const percent = total > 0 ? Math.round((completed / total) * 100) : 0;
            document.getElementById('completedCount').textContent = completed + '/' + total;
            document.getElementById('completionPercent').textContent = percent + '%';
            document.getElementById('avgRPE').textContent = total > 0 ? (totalRPE / total).toFixed(1) : '0.0';
            document.getElementById('sCoeff').textContent = (totalRPE / 10).toFixed(1);
        }

        function updateSupervisorView() {
            const week = document.getElementById('selectWeekSupervisor').value;
            const weekData = TRAINING_DATA[week];
            const table = document.getElementById('supervisorTable');

            if (!weekData) {
                table.innerHTML = '<tr><td>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</td></tr>';
                return;
            }

            let html = '<thead><tr><th>–î–µ–Ω—å</th><th>–£–ø—Ä.</th><th>–ü–æ–¥—Ö–æ–¥—ã</th><th>–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏—è</th><th>–í–µ—Å</th><th>RPE</th><th>–í—ã–ø–æ–ª–Ω–µ–Ω–æ</th><th>–ü—É–ª—å—Å</th><th>–°–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ</th><th>–ü—Ä–∏–º–µ—á–∞–Ω–∏—è</th></tr></thead><tbody>';
            let totalWorkouts = 0, completedWorkouts = 0, totalRPE = 0;

            weekData.days.forEach((dayData, dayIndex) => {
                dayData.workouts.forEach((workout, wIndex) => {
                    const id = `${week}-${dayIndex}-${wIndex}`;
                    const record = appState.workoutData[id] || {};
                    const isCompleted = record.completed;

                    totalWorkouts++;
                    if (isCompleted) completedWorkouts++;
                    const rpe = parseInt(record.rpe || workout.rpe || 0);
                    if (rpe > 0) totalRPE += rpe;

                    html += `<tr class="${isCompleted ? 'completed' : ''}">
                        <td>${dayData.day}</td>
                        <td>${workout.exercise}</td>
                        <td>${record.sets || workout.sets || '-'}</td>
                        <td>${record.reps || workout.reps || '-'}</td>
                        <td>${record.weight || workout.weight || '-'}</td>
                        <td>${record.rpe || workout.rpe || '-'}</td>
                        <td>${isCompleted ? '‚úÖ' : '‚òê'}</td>
                        <td>${record.pulse || '-'}</td>
                        <td>${record.mood || '-'}</td>
                        <td>${record.notes || '-'}</td>
                    </tr>`;
                });
            });

            html += '</tbody>';
            table.innerHTML = html;

            // Update supervisor dashboard
            const percent = totalWorkouts > 0 ? Math.round((completedWorkouts / totalWorkouts) * 100) : 0;
            document.getElementById('supervisorCompleted').textContent = completedWorkouts + '/' + totalWorkouts;
            document.getElementById('supervisorPercent').textContent = percent + '%';
            document.getElementById('supervisorAvgRPE').textContent = totalWorkouts > 0 ? (totalRPE / totalWorkouts).toFixed(1) : '0.0';
            document.getElementById('supervisorSCoeff').textContent = (totalRPE / 10).toFixed(1);

            let statusClass = 'status-error', statusText = '‚ùå –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ';
            if (percent >= 80) { statusClass = 'status-ok'; statusText = '‚úÖ –ü–æ –ø–ª–∞–Ω—É'; }
            else if (percent >= 60) { statusClass = 'status-warning'; statusText = '‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ'; }

            document.getElementById('supervisorStatus').className = 'dashboard-status ' + statusClass;
            document.getElementById('supervisorStatus').textContent = statusText;
        }

        // Init
        window.addEventListener('load', () => { console.log('Training Tracker Pro v1.1 loaded'); });
    </script>
</body>
</html>
